\documentclass[a4paper, 12pt]{article}
\usepackage[14pt]{extsizes}

\makeatletter
\newenvironment{sqcases}{%
  \matrix@check\sqcases\env@sqcases
}{%
  \endarray\right.%
}
\def\env@sqcases{%
  \let\@ifnextchar\new@ifnextchar
  \left\lbrack
  \def\arraystretch{1.2}%
  \array{@{}l@{\quad}l@{}}%
}
\makeatother
\usepackage{float}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{xcolor}

\usepackage[top=2cm, bottom=2cm, left=2cm, right=1cm]{geometry}
%\renewcommand{\baselinestretch}{1.2}
%\newcommand{\jj}{\righthyphenmin=20 \justifying}
\usepackage{ragged2e}
\justifying
\usepackage{booktabs}
\usepackage[russian]{babel}
\usepackage{amssymb}
\usepackage{enumerate}
\usepackage{units}
\long\def\comment{}

\newtheorem{theorem}{Theorem}
\newtheorem{lemma}{Lemma}
\usepackage{listings} 
\lstset{language=Python} 


\usepackage{tikz}
\usepackage{tikz-3dplot}

\usepackage{caption}
\usepackage{subcaption}
\usepackage{graphicx}

\graphicspath{{./pictures/}}
\DeclareGraphicsExtensions{.pdf,.png,.jpg,.svg}

\usepackage{pdfpages}
\usepackage{amsmath}
\usepackage{textcomp}
\usepackage{gensymb}
\usepackage{physics}
\usepackage{hyperref}


\newcommand*\diff{\mathop{}\!\mathrm{d}}
\newcommand{\slfrac}[2]{\left.#1/#2\right.}
\newcommand{\Int}[4]{\displaystyle \int_{#1}^{#2} #3 \diff #4}
\newcommand{\Intu}[3]{\displaystyle \int_{#1}^{#2} #3}

\addto\captionsrussian{\renewcommand{\figurename}{Fig.}}
\addto\captionsrussian{\renewcommand{\refname}{References}}
\addto\captionsrussian{\renewcommand{\contentsname}{Contents}}
\renewcommand{\figurename}{Fig.}
\renewcommand{\refname}{References}
\renewcommand*\contentsname{Contents}

\pdfsuppresswarningpagegroup=1

\begin{document}
	%-------------------------------------------------TITLE----------------------------------------------------------
	\thispagestyle{empty}
	\begin{center}
		\large
		\textbf{National Research University}			
		\\
		\textbf{Higher School of Economics}									\\[3 cm]
		\textbf{Moscow Institute of Electronics and Mathematics}			\\[2 cm]
									
	\end{center}
	
	\begin{center}
		\large
		\textbf{Department of Applied Mathematics}		\\[3 cm]
	\end{center}
	
	
	
	\begin{center}
		\large
		\textbf{Calculation of Electron Spectrum in Spherically Symmetric Potentials}		\\[6 cm]
		
	\end{center}
	
	\begin{flushright}
		\large
		\textbf{Elena Orlova}				\\
		\textbf{Scientific Supervisor:}			\\
		\textbf{Dr. Renat Ikhsanov}		\\
	\end{flushright}
	
	\vfill
	\begin{center}
		\large
		\textbf{Moscow 2017}
	\end{center}
	\pagebreak
	
	
	
    %-------------------------------------------------------------1-----------------------------------------------------------


\tableofcontents
\pagebreak
	
\section{Introduction}

Solutions of the Shrodinger equation are of great interest in many fields of physics and chemistry.  To find possible energy values of the particle in an exterior potential it is necessary to find eigenvalues of the radial part of the Hamiltonian. It is often impossible to solve this problem analytically in the three-dimension case. \\
We are interested in finding the particle posssible energy values in some sphericallly symmetric potentials, which describes different types of interactions. For this purpose we construct the  numerical scheme by discretizing the Laplace  operator using the finite differences and solve corresponding eigenvalue problem.\\
As a result, we have obtained the numerical results for the following potentials:  the infinite spherical potential well; finite spherical potential well; the spherical oscillator potential; the Coulomb potential; the Hulthen potential; the Morse potential; Woods-Saxon potential; Yukawa potential and the deuteron potential. We compared numerical results for all but Woods-Saxon and Yukawa potentials with known analytical solutions \cite{flugge2012practical}. As for the Woods-Saxon potential, for which there is no analytical solution, our results were verified by comparing results of two numerical methods: the extrapolation method and the eigenvalue problem solving one. For the Yukawa potential also there is no exact analytical solution, but we used approximate analytical solution presented in \cite{hamzavi2012approximate} .


%We  compared numerical results with the known analytical solutions, for which we use the following source \cite{flugge2012practical}. As for  the Woods-Saxon potential, this results was obtained by the extrapolation method and compared with results from the eigenvalue problem. This result is interesting  from physical point of view since there are no known analytical expression for the energy. For the Yukawa potential  there is no exact analytical solution, however in the paper \cite{hamzavi2012approximate} some approximate analytical solution is found by using the Nikiforov-Uvarov method.  Finally,  the central-force model of deuteron was investigated.


\section{Theoretical part}
\subsection{Differential operators in spherical coordinates}\label{dif_op_3d}
Suppose we have the standard three dimension axes. A spherical coordinate system is a coordinate system where the position of a point is specified by three quantities: the radial distance $r$ of that point from the origin, its polar angle $\theta$ measured between the polar axis (positive $z$-axis) and the line from the origin to the point, and the azimuth angle $\phi$ between the positive $x$-axis  and the line's from the origin to the point orthogonal projection on a reference plane $Oxy$.


\tdplotsetmaincoords{60}{110}
%
\pgfmathsetmacro{\rvec}{.8}
\pgfmathsetmacro{\thetavec}{30}
\pgfmathsetmacro{\phivec}{60}
%
\begin{figure}[h!]
\begin{center}
\begin{tikzpicture}[scale=5,tdplot_main_coords]
    \coordinate (O) at (0,0,0);
    \draw[thick,->] (0,0,0) -- (1,0,0) node[anchor=north east]{$x$};
    \draw[thick,->] (0,0,0) -- (0,1,0) node[anchor=north west]{$y$};
\draw[thick,->] (0,0,0) -- (0,0,1) node[anchor=south]{$z$};
    \tdplotsetcoord{P}{\rvec}{\thetavec}{\phivec}
    \draw[-stealth,color=red] (O) -- (P) node[above right] {$P$};
    \draw[dashed, color=red] (O) -- (Pxy);
    \draw[dashed, color=red] (P) -- (Pxy);
    \tdplotdrawarc{(O)}{0.2}{0}{\phivec}{anchor=north}{$\phi$}
    \tdplotsetthetaplanecoords{\phivec}
    \tdplotdrawarc[tdplot_rotated_coords]{(0,0,0)}{0.5}{0}%
        {\thetavec}{anchor=south west}{$\theta$}
\end{tikzpicture}
\end{center}
\caption{Spherical coordinates}
\end{figure}
Cartesian coordinates to spherical coordinates:
\begin{equation} \label{sph_coord}
\begin{cases}
	{x}= {r} \sin{\theta}\cos{\phi} \\
	{y} = {r} \sin{\theta}\sin{\phi} \\
	{z} = {r}\cos{\theta}
\end{cases}
\end{equation}
The Laplacian is a differential operator given by the divergence of the gradient of a function in Euclidean space. The Laplace operator in Cartesian coordinates:
 	$$\nabla^2= \frac{\partial^2}{\partial x^2}  + \frac{\partial^2}{\partial y^2} + \frac{\partial^2}{\partial z^2}$$
So, using \eqref{sph_coord} we can find Laplacian in spherical coordinates:
\begin{equation}\label{sph_lap}
	\nabla^2 = \frac{1}{r^2} \frac{\partial}{\partial r}({r^2}\frac{\partial f}{\partial r})+\frac{1}{r^2\sin{\theta}}\frac{\partial}{\partial \theta}(\sin{\theta}\frac{\partial f}{\partial \theta})+\frac{1}{r^2\sin^2{\theta}}(\frac{\partial^2 f}{\partial \phi^2})
\end{equation}
Spherical coordinates are specially convenient in case when particle potential depends only on distance from some point.


\subsection{Some  necessary special functions}
With the Laplacian in the spherical coordinates several special functions often appear.  We will describe them in the two following paragraphs.
\subsubsection{Spherical functions}
The spherical harmonics are the angular part of the family of orthogonal solutions of the Laplace equation written in the spherical coordinates \eqref{sph_lap}:
$$\nabla^2 {f} = \frac{1}{r^2} \frac{\partial}{\partial r}({r^2}\frac{\partial f}{\partial r})+\frac{1}{r^2\sin{\theta}}\frac{\partial}{\partial \theta}(\sin{\theta}\frac{\partial f}{\partial \theta})+\frac{1}{r^2\sin^2{\theta}}(\frac{\partial^2 f}{\partial \phi^2}) = 0$$
Suppose we can find solutions in the form $$f({r}, \theta, \phi) = R(r)Y(\theta, \phi)$$
Separation of variables gives two differential equations:
$$\frac{1}{R}\frac{\partial}{\partial r}(r^2 \frac {dR}{dr}) = \lambda$$
\begin{equation}\label{eq2}
	\frac{1}{Y}\frac{1}{\sin{\theta}}\frac{\partial}{\partial \theta}(\sin{\theta}\frac{\partial Y}{\partial \theta})+\frac{1}{Y}\frac{1}{\sin^2{\theta}}\frac{\partial^2 Y}{\partial \phi^2} = -\lambda
\end{equation}
The solution of \eqref{eq2} is represented in the following form, called the spherical garmonics of the degree $l$ and the order $m$:
\begin{equation}\label{sph_garm}   
   Y_l^m(\theta, \phi)=\varepsilon \sqrt{\frac{(2l+1)}{4\pi}\frac{(l-m)!}{(l+m)!}}e^{im\phi}P_l^m(\cos{\theta}),
\end{equation}
 where $\varepsilon = (-1)^m$ for $m\geq0$ and $\varepsilon=1$ for $m \leq 0$, $-l \leq m \leq l$ and $P_l^m $ is associated with the Legendre function defined by:
	$$P_l^m(x)= (1-x^2)^{m/2}\frac{d^m}{dx^m} P_l(x),$$
where $P_l(x) $ is Rodrigues formula:
	$$P_l(x) = \frac{1}{2^l l!}(\frac{d}{dx})^l (x^2-1)^l.$$
Notice that $m$ and $l$ are integers. For any given $l$ there are $(2l+1)$ possible values for $m$: $l=0, 1...$, $m = -l, -l+1,..., -1, 0, 1, .., l-1, l.$\\
%The general solution to the Laplace's equation is linear combination of the spherical harmonic functions multiplied by the appropriate scale factor $r^l$:
%	$$f(r, \theta. \phi) = \sum_{l=0} ^{\infty}\sum_{m=-l} ^{l}f_l^mr^l Y_l^m(\theta, \phi).$$
%where the $f_l^m$ are constants.


\subsubsection{Bessel functions}
The Bessel functions are canonical solutions $y(x)$ of following differential equation:
\begin{equation}\label{bess_eq}
x^2\frac{d^2 y}{dx^2}+x\frac{dy}{dx}+(x^2-\alpha^2)y = 0,
\end{equation}
where $\alpha$ is an arbitrary complex number, called the order of the Bessel function.\\
The most important cases are for $\alpha$ an integer or half-integer. Spherical Bessel functions with half-integer $\alpha$ are obtained when the Helmholtz equation is solved in spherical coordinates:
$$\nabla^2 A+k^2 A=0,$$
where $k$  is a wave number and $A$ is an amplitude.\\
When solving the Helmholtz equation in the spherical coordinates by separation of variables, the radial equation has the form:
$$x^2\frac{d^2 y}{dx^2}+2x\frac{dy}{dx}+[x^2-n(n+1)]y = 0$$
The two linearly independent solutions to this equation are called the spherical Bessel functions $j_n$ and $y_n$:
\begin{equation}\label{bess_func1}
	j_n(x) = (-x)^n\bigg(\frac{1}{x} \frac{d}{dx}\bigg)^n \frac{\sin{x}}{x}
\end{equation}
\begin{equation}\label{bess_func2}
	y_n(x) = (-x)^n\bigg(\frac{1}{x} \frac{d}{dx}\bigg)^n \frac{\cos{x}}{x}
\end{equation}
\begin{figure}[h!]
\centering
\begin{subfigure}{.5\textwidth}
  \centering
  \includegraphics[width=1.0\linewidth]{bessel1.pdf}
  \caption{$j_n(x)$}
  \label{fig1:bessel1}
\end{subfigure}%
\begin{subfigure}{.5\textwidth}
  \centering
  \includegraphics[width=1.0\linewidth]{bessel2.pdf}
  \caption{$y_n(x)$}
  \label{fig:bessel2}
\end{subfigure}
\caption{Spherical Bessel functions}
\label{fig:bessel}
\end{figure}


\subsection{Angular momentum}
The angular momentum $L$ of a material point relative to a reference point is determined by the cross product of particle's position vector $r$(relative to some origin) and its momentum vector $p$:
$$\mathbf{L = r \times  p},$$
which is to say,
%$$L_x=y p_z-z p_y, L_y=z p_x-x p_z, L_z=x p_y-y p_x$$%
$$\boldsymbol{L} = \begin{vmatrix} \boldsymbol{i} & \boldsymbol{j} & \boldsymbol{k} \\ 
x & y & z \\
p_x & p_y & p_z
\end{vmatrix}$$
This definition can be carried over to quantum mechanics, by reinterpreting $r$ as the quantum position operator   $\hat x=x$  and $p$ as the quantum momentum operator $\hat p=\frac{\hbar}{i}\nabla$:

$$\boldsymbol{L} = \frac{\hbar}{i}\begin{vmatrix} \boldsymbol{i} & \boldsymbol{j} & \boldsymbol{k} \\ 
x & y & z \\
\frac{\partial}{\partial x} & \frac{\partial}{\partial y} & \frac{\partial}{\partial z}
\end{vmatrix}$$
Writing this in coordinates, we obtain:

$$L_x = \frac{\hbar}{i}(y \frac{\partial}{\partial z}-z \frac{\partial}{\partial y}), ~L_y = \frac{\hbar}{i}(z \frac{\partial}{\partial x}-x \frac{\partial}{\partial z}), ~L_z = \frac{\hbar}{i}(x \frac{\partial}{\partial y}-y \frac{\partial}{\partial x})$$
In the next section we will consider the eigenvalues and eigenfunctions of these operators.

\subsubsection{Eigenvalues and eigenfunctions}
%Matrix multiplication is not, in general case, commutative; the difference between the two orderings is called commutator:
%$$[S, T] = ST-TS$$
%In a complex vector space, every linear transformation has special vectors, which are transformed into simple multiples of themselves, 
%$$\hat T \ket{\alpha} = \lambda \ket{\alpha},$$
%$\bra{\Psi}\ket{\Psi}$ $\expval{A}{\Psi}$
%they are called eigenvecrors of the transformation, ans the number $\lambda$ is their eigenvalue. \\[0.5cm]
%n function spaces operators, such as $d/dx, d^2/dx^2$ or $x$ behave as linear transformations. So, the eigenvectors of an operator $\hat T$ are called eigenfunctions:
%$$\hat T f(x)=\lambda f(x)$$
%$L_x$ and $L_y$ do not commute; if we test their action to $f(x, y, z)$, we notice, that:
%$$[L_x, L_y]f = (\frac{\hbar}{i})^2 (y \frac{\partial}{\partial x} -x \frac{\partial}{\partial y})f = i \hbar L_z f,$$
%so
%\begin{equation}\label{comm_L}
%	[L_x, L_y] = i \hbar L_z 
%\end{equation}
%It follows also that 
%$$[L_y, L_z] = i \hbar L_x $$
%$$[L_z, L_x] = i \hbar L_y$$
We have the angular momentum operator $\hat L = (\hat L_x,\hat L_y, \hat L_z)$ and these components sutisfy the following commutation relations:
\begin{equation}\label{comm_L}
	[\hat L_i, \hat L_j] =i \hbar \epsilon_{ijk}  \hat L_k, ~~~i, j, k =1,2,3
\end{equation}
where $\epsilon_{ijk}$ is Levi-Civita symbol. The definition in three dimension is the following:  $\epsilon_{ijk}$ is equal to $1$ if $(i, j, k)$ is an even permutation of $(1, 2, 3)$,  $-$1 if it is an odd permutation, and  $0$ if any index is repeated.\\
And 
$$[\hat L_i, \boldsymbol{\hat L^2}] = 0, $$
where $\mathbf{\hat L^2 = \hat L_x^2+\hat L_y^2+\hat L_z^2} .$\\
The angular momentum operators are commonly used in the solution of spherical symmetry problems. Then the momentum in the spherical coordinates: 
$$-\frac{1}{\hbar^2}L^2=\frac{1}{\sin \theta}\frac{\partial}{\partial \theta}(\sin \theta \frac{\partial}{\partial \theta})+\frac{1}{\sin^2 \theta}\frac{\partial^2}{\partial \phi^2}.$$
The eigenvalues and eigenfunctions are the following:
$$L^2 f_l^m = \hbar^2l(l+1) f_l^m,$$
$$L_z f_l^m = \hbar m f_l^m,$$
where $f_l^m = Y_l^m$ - spherical harmonics, defined in \eqref{sph_garm}.




%Using these fundamental commutation relations the entire theory of angular momentum can be deduced.
%But the square of the total angular momentum,
%$$L^2 = L_x^2+L_y^2+L_z^2$$
%oes commutate with $L_x$ :
%$$[L^2, L_x] = 0$$
%It follows:
%$$[L^2, L_y] = 0$$
%$$ [L^2, L_z] = 0, $$
%or, 
%$$[L^2, L] = 0.$$



\subsection{Spin}
In classical mechanics, an object's rotation around a fixed axis  is described by two kinds of angular momentum: orbital ($L = r \times p$) associated with the motion of the center of mass and spin($S = I \omega$), associated with motion about the center of mass.  Analogous things take place in quantum mechanics: in addition to orbital angular momentum associated with the motion of electron around the nucleus (in case of hydrogen ) and which  described by the spherical harmonics, but electron also carries another form of angular momentum, which has nothing to do with motion in space, but which is somewhat analogous to classical spin. Notice that electron is a structureless point particle, and its spin angular momentum cannot be decomposed into orbital one of constituent parts. So elementary particles have intrinsic angular momentum $S$ and "extrinsic" angular momentum $L.$ (\cite{griffiths2016introduction})\\
The existence of thespin angular momentum was proven in experiments, for instance the Stern-Gerlach experiment.\\
The algebraic  theory of  the spin is the same as the theory for the orbital angular momentum. So there are the fundamental commutation relations as \eqref{comm_L}.
%\begin{equation}\label{comm_S}
%[S_x, S_y] = i \hbar S_z, ~~~~[S_y, S_z] = i \hbar S_x, ~~~~ [S_z, S_x] = i \hbar S_y.
%\end{equation}
%It follows that the eigenvectors satisfy
%$$S^2 \ket{s ~m} = \hbar^2 s(s+1) \ket{s~m},$$
%$$S_z \ket{s ~m} = \hbar m \ket{s~m}.$$
But these time the eigenvectors are not spherical harmonics (they are not functions of $\theta$ and $\phi$), so there is no reason to exclude half-integers values of $s$ and $m$:
$$s = 0, \frac{1}{2}, 1, ...;  ~ m = -s, -s+1,...,s-1, s. $$

\subsubsection{Spin $\frac{1}{2}$}
An important case is $s = \frac{1}{2}$, corresponds to, for example,  the electron. There are two eigenstates: $\displaystyle{\ket{\frac{1}{2} ~ \frac{1}{2}}}$ and $\displaystyle{\ket{\frac{1}{2} ~ -\frac{1}{2}}}
$. %Using these as basis vectors, the general state a particle with the spin $\frac{1}{2}$ can be described as a two-element column matrix, called spinor:
%$$\chi = \begin{pmatrix} a \\ b  \end{pmatrix} = a \chi_+ + b \chi_-,$$ with $\chi_+ = \begin{pmatrix} 1\\ 0  \end{pmatrix}, ~~ \chi_- = \begin{pmatrix} 0\\ 1  \end{pmatrix}.$\\
Let's add the following discrete variable: the spin quantum number $\sigma.$ Then the particle's wave function becomes:
$\Psi = \Psi(x,y,z, \sigma, t), $ and normalization condition becomes $\displaystyle{\sum_i \iint |\Psi_{\sigma_i} (x,y,z, \sigma, t)|^2dV=1}.$ \\
For electrons with $s = \frac{1}{2}$: $\sigma_1 = \frac{1}{2}$ and $\sigma_2 = -\frac{1}{2}$. Then  the spin wave function is
$$\displaystyle{\phi(t) = 
\begin{pmatrix}
	\chi_{1/2}(t) \\
	\chi_{-1/2}(t)
\end{pmatrix} = 
\begin{pmatrix}
	\chi_1 (t) \\
	\chi_2(t)
\end{pmatrix}} - \text{spinor}.$$
The normalisation condition is
$$|\chi_1| ^2 + |\chi_2|^2 =1.$$
The hermitian inner product of spinors is the following:
$$\phi_1 = \begin{pmatrix}
	a_1 \\
	a_2
\end{pmatrix}, ~ \phi_2 = \begin{pmatrix}
	b_1 \\
	b_2
\end{pmatrix} \Rightarrow \bra{\phi_1}\ket{\phi_2} = a_1^* b_1 + a_2^* b_2.$$
The quantum mechanical operators associated with this spin observables are:
$$\hat{S}  = \frac{\hbar}{2} \hat{ \sigma},$$
For  particles with spin $\frac{1}{2}$  $\sigma_x$, $\sigma_y$, $\sigma_z$ there are three matrices called  the Pauli matrices given by:
$$\sigma_x = 
\begin{pmatrix}
0 & 1 \\
1 & 0
\end{pmatrix} ~~~
\sigma_y = 
\begin{pmatrix}
0 & -i \\
i & 0
\end{pmatrix} ~~~
\sigma_z = 
\begin{pmatrix}
1 & 0\\
0 & -1
\end{pmatrix}$$
$S_x, ~S_y$ and $S_z$ satisfy  canonical momentum commutation relations. It is easy to check, that the Pauli matrices are hermitian and unitary.

\subsection{Time dependent Schrodinger equation} 
In one-dimensional case, the total energy of a particle is described by the Hamiltonian: 
\begin{equation}\label{hamiltonian}
	\hat{H} =- \dfrac{\hbar}{\ {2}{m}} \nabla^2  + V(x),
\end{equation}
where $\hbar$ is the Planck constant, ${m}$ is  mass of the particle, $\nabla^2 = \frac{\partial^2}{\partial x^2}$ is the Laplasian,  $V$ - the potential .\\
The Schrodinger equation describes a particle dynamics:
\begin{equation}\label{schr_eq}
	i \hbar \frac{\partial \Psi(x, t)}{\partial t} = H \Psi(x,t),
\end{equation}
where $\Psi(x, t)$ is the wave function, $H$ is the Hamiltonian.\\
Bohr provided the statistical interpretation of the wave function: $|\Psi(x,t)|^2 $ gives the probability density in coordinate space. Then $|\Psi(x,t)|^2 dx $ gives probability of finding the particle at point $(x+dx)$ at time $t.$\\
It follows that 
$$\int_{-\infty}^\infty |\Psi(x,t)|^2 dx = 1$$
Such function is called the normalized wave function.\\
%Suppose we are finding solutions in the following form $$\Psi(x, t) = \psi(x) f(t).$$
General solution of the time dependent Schrodinger equation is $$\Psi(x,t) = \sum_{n=1}^\infty c_n \psi_n (x) e^{-i E_nt/ \hbar},$$  where stationary states  $ \psi_n (x)$ are solutions of time independent Schrodinger equation:
\begin{equation}\label{t-indep}
	H \psi = E \psi,
\end{equation}
and the coefficients $c_n$  are determined in order to fit the initial conditions.
As it turns out, it is often impossible to solve even stationary Schrodinger equation analytically. In this case numerical methods are used. In the following sections the main ideas of this methods are described.

\subsection{Finite difference and eigenvalue problem} \label{sec:numerical}
In the spherical summetry case we obtain the following equation, which is called the radial (see section \ref{e_sph_poten}): 
$$-\frac{\hbar^2}{2m}\frac{d^2 u}{d r^2}+[V+\frac{\hbar^2}{2m}\frac{l(l+1)}{r^2}]u = Eu,$$
where $u(r) = r R(r).$ \\
If  $l=0$ the equation says:
$$-\frac{\hbar^2}{2m}\frac{d^2 u}{d r^2}+Vu = Eu,$$
$$-\frac{\hbar^2}{2m}u''+Vu = Eu.$$
If we let $\hbar = 1, m=1$ (atomic units):
$$-\frac{u''}{2}+Vu = Eu,$$
$$u'' +(-2V)u = -2Eu,$$
$$(\frac{d^2}{d r^2}-2V)u = -2Eu.$$
The last equation says $-2E$ is the eigenvalue of $(\frac{d^2}{d r^2}-2V)$ operator. To find this value, we have to approximate the continuous expressions by the discrete ones. Also we need boundary conditions. Since the wave function is typically exponentially damped, we can assume that $ u (r) = 0 $ for $ r \geq L $ for some sufficiently large $ L $ (so called effective infinity). \\
Thus we obtain the eigenvalue problem with the boundary conditions $u(0) = 0$ (since $ u (r) = r R (r) $) and $ u (L) = 0 $. We define the step $ h = L N ^{-l}$, where $ N $ is  positive integer (divide the segment $ [0, L] $ into N parts), $ r_n = nh $ is the grid nodes.\\
The first derivative is 
 $$\displaystyle{{u_n'} = \frac{u_{n+1}-u_{n}}{h}}.$$ 
The second derivative is given by the following relation : $$\displaystyle{{u_n''} = \frac{u_{n+1}-2u_n +u_{n-1}}{h^2}}.$$ 
Then $ u_n'' \to u''(r_n)$ and 
$$\displaystyle{
\begin{bmatrix}
u_1'' \\
u_2'' \\
u_3'' \\
\vdots \\
u_n''
\end{bmatrix}
 = -\frac{1}{h^2} \begin{bmatrix}
-2 & 1 &0&0&0& \cdots & 0 \\
1 & -2 & 1& 0&0&\cdots & 0 \\  
0&1 & -2 & 1& 0&\cdots & 0 \\  
\vdots & \vdots &\vdots & \vdots & \ddots & -2& 1  \\
0 & 0&0 &0& \cdots &1 & -2
\end{bmatrix}
\begin{bmatrix}
u_1
\\
u_2
\\
u_3
\\
\vdots
\\
u_n
\end{bmatrix}}$$
Note that the resulting matrix has a tridiagonal form.\\
Now we need to approximate $-2V(r_n)u(r_n)$:
$$-2V(r_n)u(r_n) = \begin{bmatrix}
-2V(r_1) & 0 &0&0&0& \cdots & 0 \\
0 & -2V(r_2) & 0& 0&0&\cdots & 0 \\  
0&0 & -2V(r_3) & 0& 0&\cdots & 0 \\  
\vdots & \vdots &\vdots & \vdots & \ddots & \vdots& \vdots  \\
0 & 0&0 &0& \cdots &0 & -2V(r_{n-1})
\end{bmatrix}
\begin{bmatrix}
u_1
\\
u_2
\\
u_3
\\
\vdots
\\
u_n
\end{bmatrix}$$
It is easy to check that $\displaystyle{\| u_n''-u''(r_n) \| \sim O(h^2)}.$\\
Thus our problem is to find the eigenvalues for the sum of the matrices presented.

\subsection{Richardson method}
Let's use some ideas from the Richardson extrapolation method to find the spectrum. We discretize the uniform grid $[0, L]$ into $N$ and 2$N$ parts with the step 2$h$ and $h$ correspondingly. Suppose we have the residual of the order $h^2$, then 
$$E_{N} - E = C (2h)^2,$$
$$E_{2N} - E = C h^2,$$
where $E$ is the exact energy value, $C$ is some constant. We obtain 
\begin{equation}
	E = \frac{4 E_N - E_{2N}}{3}.
\end{equation}
This equation can be used to 'predict' the energy value if the exact solution is unknown.

\section{Electron in spherically symmetric potentials}\label{e_sph_poten}
In this section we will try to solve some problems with concrete potentials. But, firstly, we are going to consider some principles for solving  Schrodinger equation in three dimensions.\\
Using results from paragraph \ref{dif_op_3d} and the Laplacian in the spherical coordinates \eqref{sph_lap}  we find time-independent Schrodinger equation in the form:
\begin{equation}\label{t-indep_3d}
-\frac{\hbar^2}{2m}[\frac{1}{r^2} \frac{\partial}{\partial r}({r^2}\frac{\partial \psi}{\partial r})+\frac{1}{r^2\sin{\theta}}\frac{\partial}{\partial \theta}(\sin{\theta}\frac{\partial \psi}{\partial \theta})+\frac{1}{r^2\sin^2{\theta}}(\frac{\partial^2 \psi}{\partial \phi^2}) ] + V\psi = E \psi
\end{equation}
We are looking for solutions that are separable into products:
$$\psi (r, \theta, \psi) = R(r)Y(\theta, \psi),$$
putting this in \eqref{t-indep_3d} and using results from previous sections, we get:
\begin{equation}\label{r_eq}
	\frac{1}{R}\frac{\partial}{\partial r}(r^2 \frac{\partial R}{\partial r}) - \frac{2m r^2}{\hbar^2}[V(r)-E] = l(l+1),
\end{equation}
\begin{equation}\label{Y_eq}
	\frac{1}{Y}\frac{1}{\sin \theta}\frac{\partial}{\partial \theta}(\sin \theta \frac{\partial Y}{\partial \theta}) + \frac{1}{\sin^2 \theta}\frac{\partial^2 Y}{\partial \phi^2}=-l(l+1).
\end{equation}
The equation \eqref{Y_eq} is the angular part of the wave function, \eqref{r_eq} is the radial part of the wave function. Notice, that  the angular part is the same for all spherically symmetric potentials, but for our purposes it is important to investigate the radial part, because spherically symmetric potentcials depend only on $r.$\\
Let $u(r) = r R(r)$, so:
\begin{equation}\label{r_eq}
	-\frac{\hbar^2}{2m}\frac{\partial^2 u}{\partial r^2}+[V+\frac{\hbar^2}{2m}\frac{l(l+1)}{r^2}]u = Eu
\end{equation}
It is so called radial equation. Normalization condition becomes
$$\int_{0}^{\infty} |u|^2  dr=1$$

\subsection{Spherically potential well}

\subsubsection{Infinite spherical well}
For the infinite spherical well with the radius $a$ the potential is
$$V(r)= \begin{cases}
0, \text{if } r\leq a\\
\infty, \text{if } r>a
\end{cases}$$
Then, inside the well the radial equation \eqref{r_eq} says
\begin{equation}\label{rad_well}
\frac{d^2 u}{dr^2} = [\frac{l(l+1)}{r^2} - k^2]u,
\end{equation}
where
$$k = \frac{\sqrt{2mE}}{\hbar}$$
We need to solve this equation using the boundary condition $u(a) = 0.$
Suppose  $l=0$:
$$\frac{d^2 u}{dr^2} = -k^2 u \Rightarrow u(r) = A \sin{(kr})+B\cos{(kr})$$
This case is easy. But notice, the actual radial wave function is $R(r)= u(r)/r$, and $(\cos (kr))/r$ blows up as  $r \to 0.$ Thus $B =0.$ Then it is requires $\sin (ka) =0$, and hence $ka = n \pi,$ for some integer $n$. The allowed energies are
$$E_{n0} = \frac{n^2 \pi^2 \hbar^2}{2 ma^2}, ~ n = 1,2,...$$
To solve the equation in all cases define a new variable $z= k r$, and let  $u = z^{1/2}\phi{z}.$
Then \eqref{rad_well} takes the following form:
$$\frac{d^2 \phi}{dz^2}+\frac{1}{z}\frac{d \phi}{dz}+[1 - \frac{(l+\frac{1}{2})^2}{z^2}]\phi = 0.$$
This is Bessel's differential equation \eqref{bess_eq}. So, general solution is
$$u(r)=Ar j_l(kr)+Bn_l(kr),$$
where $j_l(x)$ and  $n_l(x)$ are the spherical Bessel functions \eqref{bess_func1}, \eqref{bess_func1} of an order $l$.
Notice, that  \eqref{bess_func1} blow up at the origin. So we must have $B_l=0$, and hence
$$R(r)=A j_l(kr).$$
The boundary condition says $R(a)=0,$ which implies $k$ must be chosen such that
$$j_l(kr)=0.$$
This means, that $ka$ is zero of the $i^{th}$-order spherical Bessel function, but  they are not located in good points, such as $n$ or $\pi n$ . The boundary condition requires 
$$k = \frac{1}{a}\beta_{nl},$$
where $\beta_{nl}$ is the $n^{th}$ zero of the  $l^{th}$  spherical Bessel function. The allowed energies are defines by
\begin{equation}\label{sol_inf_well}
E_{nl}=\frac{\hbar^2}{2ma^2}\beta_{nl}^2,
\end{equation}
and the wave functions are
$$\psi_{nlm}(r, \theta,\phi) = A_{nl} j_l(\beta_{nl}r/a) Y_l^m(\theta, \phi),$$
where $A_{nl}$ is a constant determined by normalization, $Y_l^m(\theta, \phi)$ is spherical harmonics \eqref{sph_garm}.
We assume atomic units, so $\hbar = 1, m=1.$ As an example we consider finite spherical well with $\ a = 5 $ a.u. Results are presented in the  table \ref{fig:inf_well}.


\begin{figure}[h!]
\centering
\begin{tabular}{lrrrr}
\toprule
{} &     $n=1$ &     $n=2$ &     $n=3$ &     $n=4$ \\
\midrule
$l=0$ &  0.197443 &  0.789522 &  1.776613 &  3.158087 \\
$l=1$ &  0.403741 &  1.193512 &  2.377944 &  3.957047 \\
$l=2$&  0.664243 &  1.654381 &  3.037127 &  4.814305 \\
$l=3$ &  0.976643 &  2.170278 &  3.752704 &  5.728436 \\
$l=4$ &  1.339230 &  2.740140 &  4.524032 &  6.698532 \\
\bottomrule
\end{tabular}
\caption{$E_{nl}$ in a.u. of an electron in an infinite spherical well of radius $a=5$ a.u.}
\label{fig:inf_well}
\end{figure}

 


\subsubsection{Finite spherical well}
For the finite spherical well the  potential is defined as
$$V(r)=\begin{cases}
-V_0, ~\text{if } r< R\\
~~~~0, ~\text{if } r>R
\end{cases}$$
Let
$$\frac{2m|E|}{\hbar^2} = \varkappa^2, ~~~~\frac{2m V_0}{\hbar^2}=k_0^2, ~~~~\frac{2m(V_0-|E|)}{\hbar^2} =k^2,$$
then the radial equation inside of the well and outside are correspondently:
\begin{equation}\label{rad1}
	\frac{d^2 u}{du^2}+[k^2-\frac{l(l+1)}{r^2}]u=0
\end{equation}
\begin{equation}\label{rad2}
	\frac{d^2 u}{du^2}+[-\varkappa^2-\frac{l(l+1)}{r^2}]u=0
\end{equation}
The solution of the equation \eqref{rad1} is a spherical Bessel function (with the boundary confition $u(0) =0$):
$$r u(r) =A j_l(kr), ~r< R.$$
To find the solutions of the equation \eqref{rad2} we need to define spherical Hankel functions:
$$h_l(x) = j_l(x)+in_l(x),$$
$$h_l^*(x)=j_l(x)-in_l(x),$$
where $j_l(x)$ and $n_l(x)$ are spherical Bessel functions \eqref{bess_func1}, \eqref{bess_func2}.\\
As $r \to \infty$
$$h_l(x) \to \frac{e^{[ix-\pi (l+1)/2]}}{x}$$
$$h_l^*(x) \to \frac{e^{-[ix-\pi (l+1)/2]}}{x}$$
The solution of the quation \eqref{rad2} is a spherical Hankel function of an imaginary argument:
$$r u(r) = B h_l^{(1)}(i \varkappa r), ~r>R.$$
We are interested in finding constants $A$ and $B$ from continuity and normalization condition. First match the wavefunction:
\begin{equation}\label{cond_1}
	A j_l(kR)=B h_l(i \varkappa R).
\end{equation}
Second match the first derivative:
\begin{equation}\label{cond_2}
	A k \bigg[\frac{d j_l(\rho)}{d\rho}\bigg]_{\rho = kR} = A i \varkappa \bigg[\frac{d j_l(\rho)}{d\rho}\bigg]_{\rho = i \varkappa R}.
\end{equation}
Now divide \eqref{cond_2} by \eqref{cond_1}, then the constants cancel out. This trick is called logarithmic derivative:
$$k\bigg[ \frac{\frac{d j_l(\rho)}{d \rho}}{j_l(\rho)} \bigg]_{\rho = kR} = i\varkappa \bigg[ \frac{\frac{d h_l(\rho)}{d \rho}}{h_l(\rho)} \bigg]_{\rho = i \varkappa R} $$
 Then, the solution of the problem depends on the value of $l$ . Let $l=0$, the boundary condition becomes
$$k \bigg[ \frac{\frac{\cos \rho}{\rho} - \frac{\sin \rho}{\rho^2}}{\frac{\sin \rho}{\rho}} \bigg]_{\rho = kR} = i \varkappa \bigg[ \frac{\frac{i e^{i \rho}}{i \rho} - \frac{e^{i \rho}}{i \rho^2}}{\frac{e^{i \rho}}{i \rho}} \bigg]_{\rho = i \varkappa R},
$$
divide and substitute for  $\rho$:
$$k \bigg(\ctg(kR)-\frac{1}{kR}\bigg) = i \varkappa \bigg( i - \frac{1}{i \varkappa R} \bigg),$$
\begin{equation}\label{eq_sol}
	k \ctg(kR) = - \varkappa.
\end{equation}
This is transcendental equation, but we can solve it numerically for  $k$,  for which $k_0^2-\varkappa^2=k^2.$ Also, it is possible that there can be no solution. For instance, we can solve this equation graphically, but remember, it is only for case $l=0.$ We are interested in more general cases.\\
For finding numerical solutions of our problem (our problem is to calculate the possible values of the electron energy) not only for $l=0$ it is convenient to use the following form of \eqref{eq_sol} with the notations $kR = x, ~k_0 R=x_0, ~\frac{k}{k_0} = \xi, ~\varkappa R = \sqrt{1=\xi^2}$:
\begin{equation}\label{eq_sol1}
	\tan(x_0 \xi) = f_l(x_0 \xi),
\end{equation}
where
$$f_0(x_0, \xi) = -\frac{\xi}{\sqrt{1-\xi^2}},$$
$$f_1(x_0, \xi) = \frac{x_0 \xi}{1+\frac{\xi^2}{1-\xi^2}(1+x_0 \sqrt{1-\xi^2})}.$$ 
It can be easily seen that in case $l=0$ \eqref{eq_sol1} takes the form \eqref{eq_sol}. In the further analysis we assume atomic units, so $\hbar = 1, m=1.$ By substituting values of $k_0, k$ and $\varkappa$ to the \eqref{eq_sol} we obtain:
$$\tan(\sqrt{2} a \sqrt{V_0-E})=-\sqrt{\frac{V_0}{E}-1}$$ 
As an example we consider finite spherical well with $\ a = 5 $ a.u.,$ V_0 = 10$ a.u. We solved the equation \eqref{eq_sol} using Newton's method. The resulting energies are given in the Figure~\ref{fig:finite_well_sol}.
\begin{figure}[h!]
\centering
\begin{subfigure}{.5\textwidth}
  \centering
  \includegraphics[width=1.0\linewidth]{tan-sqrt.pdf}
  \caption{$\tan(\sqrt{2} a \sqrt{V_0-E})=-\sqrt{\frac{V_0}{E}-1}$}
  \label{fig1:tan-sqrt}
\end{subfigure}%
\begin{subfigure}{.5\textwidth}
  \centering
  \includegraphics[width=1.0\linewidth]{ens_finite.pdf}
  \caption{Energy levels (a.u.)}
  \label{fig:finite_well_sol}
\end{subfigure}
\caption{Finite spherical well $V_0 = 10$ a.u., $a=5.0$ a.u.}
\label{fig:fin_well}
\end{figure}
For $l=1$ we have the formula:
$$\tan(\sqrt{2} a \sqrt{V_0-E}) = \frac{a E \sqrt{2(V_0 - E)}}{V_0+a V_0 \sqrt{2E} -a \sqrt{2} E^{3/2}}.$$
The resulting energies are given in the Figure \ref{fig:fin_well_l1}
\begin{figure}[h!]
\centering
\begin{subfigure}{.5\textwidth}
  \centering
  \includegraphics[width=1.0\linewidth]{ens_fig_l1.pdf}
  \caption{$\tan(\sqrt{2} a \sqrt{V_0-E})=-\sqrt{\frac{|E|}{V_0}-1}$}
  \label{fig1:tan-sqrt}
\end{subfigure}%
\begin{subfigure}{.5\textwidth}
  \centering
  \includegraphics[width=1.0\linewidth]{energies_l1.pdf}
  \caption{Energy levels (a.u.)}
  \label{fig:finite_well_sol}
\end{subfigure}
\caption{Finite spherical well in case $l=1$ $V_0 = 10$ a.u., $a=5.0$ a.u.}
\label{fig:fin_well_l1}
\end{figure}

\subsection{Isotropic Harmonic Oscillator}
For the isotropic harmonic oscillator the potential is defined as
$$V(r) = \frac{1}{2} m \omega^2 r^2 $$
Isotropy means that the frequencies for independent $x$,$y$, $z$ oscillations are the same. So for the oscillator in 3 dimensions we can use creation and annihilation operators $\hat{a}_x^\dag$, $\hat{a}_y^\dag$ ,$\hat{a}_z^\dag$ and $\hat{a}_x$,  $\hat{a}_y$, $\hat{a}_z$ associated with 1D oscillators in the $x$,$y$,and $z$ directions. The Hamiltonian then takes the form:
$$H = \hbar \omega (\hat{N}_1 + \hat{N}_2 + \hat{N}_3 + \frac{3}{2}) = \hbar \omega (\hat{N} + \frac{3}{2}),$$
where $\hat{N} = \hat{N}_1 + \hat{N}_2 + \hat{N}_3 .$\\
For analytical solution we use the standard separation variables procedure, then the radial equation  $\eqref{r_eq}$ takes the form:
$$-\frac{\hbar^2}{2m}\frac{\partial^2 u}{\partial r^2}+[\frac{1}{2} m \omega^2 r^2+\frac{\hbar^2}{2m}\frac{l(l+1)}{r^2}]u = Eu$$
However, a  3D oscillator spectrum finding procedure is complicated, due to this reason we used the numerical methods, described in subsection  $\ref{sec:numerical}$, for solving the problem and compared it with the known formula:
\begin{equation}
	E_{nl} = \hbar \omega (2 n_r +l+\frac{3}{2}),~~ n_r = 0,~1,~2,...
\end{equation}
Results are represented in the Figure \ref{table:Harm_osc} and  \ref{fig:Harm_osc}. For more detailed information about numerical experiment see Appendix.
\begin{figure}[h!]
\centering
\begin{subfigure}{.4\textwidth}
\begin{tabular}{lrrrr}
\toprule
{$n$} &     {Numerical} &     {Analytical}   \\
\midrule
$ 0 $&   0.5196\textcolor{red}{08} &    0.519615 \\
$ 1 $ &   1.212\textcolor{red}{398} &    1.212436 \\
$ 2$ &   1.905\textcolor{red}{165} &    1.905256 \\
$ 3 $ &   2.59\textcolor{red}{7907} &    2.598076 \\
$ 4$ &   3.290\textcolor{red}{626} &    3.290897 \\
$ 5 $ &   3.983\textcolor{red}{320} &    3.983717 \\
\bottomrule
\end{tabular}
\caption{$l=0$}
\end{subfigure}%
\begin{subfigure}{.45\textwidth}
\begin{tabular}{lrr}
\toprule
{$n$} &  Numerical &  Analytical \\
\midrule
0 &   0.8660\textcolor{red}{16} &    0.866025 \\
1 &   1.5588\textcolor{red}{07} &    1.558846 \\
2 &   2.251\textcolor{red}{574} &    2.251666 \\
3 &   2.944\textcolor{red}{318} &    2.944486 \\
4 &   3.637037 &    3.637307 \\
5 &   4.3\textcolor{red}{29732} &    4.330127 \\
\bottomrule
\end{tabular}
\caption{$l=1$}
\end{subfigure}
\caption{$E_{nl}$ in a.u. for harmonic oscillator }
\label{table:Harm_osc}
\end{figure}

\begin{figure}[h!]
\centering
\begin{subfigure}{.5\textwidth}
  \centering
  \includegraphics[width=1.0\linewidth]{harm_osc.pdf}
  \caption{Spectrum in case $l=0$ (a.u.)}
  \label{fig1:harm_osc}
\end{subfigure}%
\begin{subfigure}{.5\textwidth}
  \centering
  \includegraphics[width=1.0\linewidth]{harm_osc1.pdf}
  \caption{Spectrum in case $l=1$( a.u.)}
  \label{fig:harm_osc1}
\end{subfigure}
\caption{Isotropic Harmonic Oscillator}
\label{fig:Harm_osc}
\end{figure}
\pagebreak


\subsection{Hydrogen Atom}
From the Coulomb's law, the potential energy (in a.u.) is 
\begin{equation}\label{h2_potrntial}
	V(r) = -\frac{1}{r},
\end{equation}
and the radial equation $\eqref{r_eq}$  says
$$-\frac{1}{2}\frac{d^2 u}{dr^2}+[-\frac{1}{r}+\frac{1}{2}\frac{l(l+1)}{r^2}]u = Eu.$$
The analytical solution is known:
\begin{equation}\label{h2_sol}
   E_n = -\frac{1}{2 n^2}
\end{equation}
Notice, that the hydrogen's spectrum depends only on the energy level $n$.\\
We used the numerical methods from the section $\ref{sec:numerical},$ and results are represented in the Figure \ref{fig:h2_bar}.
\begin{figure}[h!]
\centering
\begin{tabular}{lrr}
\toprule
\centering
$n$ &         Numerical &         Analytical \\
\midrule
1 & -0.\textcolor{red}{499911} & -0.500000 \\
2 & -0.12\textcolor{red}{4994} & -0.125000 \\
3 & -0.05555\textcolor{red}{4} & -0.055556 \\
4 & -0.031250 & -0.031250 \\
5 & -0.020000 & -0.020000 \\
\bottomrule
\end{tabular}
\caption{$E_{nl}$ in a.u. of The Hydrogen Atom}
\label{fig:h2_bar}
\end{figure}\\
We have some problems with the convergence, because the potential $\eqref{h2_potrntial}$ is singular at point 0. Graphical illustration of the spectrum is given in Figure \ref{fig:h2_spectrum}.
\begin{figure}[h!]
\centering
\begin{subfigure}{.2\textwidth}
  \centering
  \includegraphics[width=1.0\linewidth]{h2_atom.pdf}
\end{subfigure}
\caption{The Hydrogen Atom Spectrum (in a.u.)}
\label{fig:h2_spectrum}
\end{figure}


\subsection{Woods-Saxon potential}
The Woods-Saxon potential describes the interaction of the protons and neutrons with the heavy nucleus inside the atomic nucleus:
\begin{equation}
    V(r) = -\frac{V_0}{1+e^\frac{r-R}{a}},
\end{equation}
where $a<<R.$\\ 
$R$ is a the nuclear radius, $a$ is the parameter that characterizes the thickness of a surface layer within which the potential falls from $V=0$ outside the nuclear to  $V = -V_0$ inside one. If let $a=0$, we obtain a potential well with a potential jump at the nuclear surface. \\
The radial equation $\eqref{r_eq}$  says:
$$-\frac{\hbar^2}{2m}\frac{\partial^2 u}{\partial r^2}+[-\frac{V_0}{1+e^\frac{r-R}{a}}+\frac{\hbar^2}{2m}\frac{l(l+1)}{r^2}]u = Eu.$$
When using the Schrodinger equation to find the spectrum of nucleons subjected to the Woods-Saxon potential, it is impossible to find the analytical solution. Numerical method results are shown in the Figure \ref{fig:WS_potential1}.
\begin{figure}[h!] 
\centering
\begin{subfigure}{.5\textwidth}
  \centering
  \includegraphics[width=1.0\linewidth]{WS_poten.pdf}
  \caption{Spectrum in case $l=0$ (a.u.)}
  %\label{fig1:WS_spc}
\end{subfigure}%
\begin{subfigure}{.5\textwidth}
  \centering
  \includegraphics[width=1.0\linewidth]{WS_wave.pdf}
  \caption{Wave functions in case $l=1$}
  %\label{fig:wave_func}
\end{subfigure}
\caption{Woods-Saxon potential}
\label{fig:WS_potential1}
\end{figure}



\subsection{Hulthen Potential}
The Hulthen potential is given by
\begin{equation}
    V(r) = - V_0 \frac{e^{-\frac{r}{a}}}{1 - e^{-\frac{r}{a}}}.
\end{equation}
Our problem to find the spectrum in case $l=0.$\\
The radial part $\eqref{r_eq}$ of the Schrodinger equation in a.u.  says:
$$-\frac{1}{2}\frac{\partial^2 u}{\partial r^2}+[- V_0 \frac{e^{-\frac{r}{a}}}{1 - e^{-\frac{r}{a}}} +\frac{1}{2}\frac{l(l+1)}{r^2}]u = Eu.$$
The analytical solution is known:
\begin{equation}\label{hult_sol}
	E_n = -V_0\bigg(\frac{\beta^2 - n^2}{2n\beta}\bigg)^2,
\end{equation}
\begin{equation}\label{hult_cond}
	\beta^2 > n^2, 
\end{equation}
where $\beta^2 = \displaystyle{\frac{2m V_0}{\hbar^2}a^2} > 0.$\\
If we rewrite \eqref{hult_sol} in the atomic units:
$$E_n = -V_0\bigg(\frac{2 V_0 a^2 - n^2}{2n a \sqrt{2V_0}}\bigg)^2,$$
and compare it with the numerical methods from section  \ref{sec:numerical}.  The resulting table is shown in Figure \ref{fig:Hult_spectrum}.
\begin{figure}[h!]
\centering
\begin{tabular}{lrr}
\toprule
\centering
$n$ &         Numerical &         Analytical \\
\midrule
1 & -7.999\textcolor{red}{88128221} & -8.0 \\
2 & -0.12\textcolor{red}{4924678667} & -0.125 \\
\bottomrule
\end{tabular}
\caption{$E_{n0}$ in a.u. for the Hulthen Potential}
\label{fig:Hult_spectrum}
\end{figure}\\
In our calculation we let $V_0 = 10 a.u.,~a = 0.5,$ so from the condition \ref{hult_cond}: $2.5 > n^2,$ we obtain only two energy levels.\\
Notice, that the Hulthen potential behaves like  a Coloumb potential at small values of $r:$
$$V_c = -\frac{V_0 a}{r},$$
and for large values of $r$ it decreases expotentially so that its "capacity" for bound states is smaller than that of $V_c.$


\subsection{Morse potential}
The Morse potential describes the vibrations of a two-atomic molecule:
\begin{equation}
  V(r) = D(e^{-2\alpha x} - 2e^{-\alpha x}), 
\end{equation}
$$x= \frac{r-r_0}{r_0}.$$
This formula is used to model the atom-surface interaction, and  $r$ is the coordinate perpendicular to the surface, $r_0$ is the equilibrium bond distance, $D$ is the well depth and $\alpha$ controls the 'width' of the potential (the smaller $\alpha$ is, the larger the well). \\
The parameters $D,$ $\alpha$ and $r_0$ are known for some typical molecules such as $H_2$ or $H Cl$ from experiments. We will research the hydrogen atom, for more detailed information abour parameters see Appendix. The problem is to find the spectrum for $l=0$ bond states. \\
The radial equation 
 in a. u.  says:
$$-\frac{1}{2m}\frac{\partial^2 u}{\partial r^2}+[D(e^{-2\alpha x} - 2e^{-\alpha x})+\frac{1}{2m}]u = Eu.$$
The analytical solution is known:
$$E_n = -D + \hbar \omega [(n+\frac{1}{2}) - \frac{1}{\xi}(n+\frac{1}{2})^2],$$
where $\xi = \frac{2 \gamma}{\alpha},$ $\gamma^2 = \frac{2 M D r_0^2}{\hbar^2},$ and $\omega$ can be found from the following equation: $\hbar \omega = \frac{\hbar^2}{2 M  r_0^2}.$\\
We used the numerical method from section \ref{sec:numerical}. Results are presented in the Figure \ref{Mor_spectrum}.
\begin{figure}[h!]
\centering
\begin{tabular}{lrr}
\toprule
$n$ &      Numerical & Analytical \\
\midrule
0 & -0.70\textcolor{red}{6884} & -0.707390 \\
1 & -0.68\textcolor{red}{6828} & -0.688970 \\
2 & -0.6\textcolor{red}{67061} & -0.671669 \\
3 & -0.6\textcolor{red}{47583} & -0.655489 \\
4 & -0.6\textcolor{red}{28393} & -0.640428 \\
5 & -0.6\textcolor{red}{09493} & -0.626487 \\
6 & -0.\textcolor{red}{590881} & -0.613665 \\
7 & -0.\textcolor{red}{572558} & -0.601964 \\
8 & -0.5\textcolor{red}{54524} & -0.591382 \\
9 & -0.5\textcolor{red}{36779} & -0.581920 \\
\bottomrule
\end{tabular}
\caption{$E_{n0}$ in a.u. for the Morse potential}
\label{Mor_spectrum}
\end{figure}
Notice, that at large distances the potential corresponds to the attraction forces, it comes to a minimum $-D$ at $x=O$ or $r=ro_0$, but produces a strong repulsion if the two nuclei approach even closer.\\
Around $x=0$ it may be expanded into a series:
 \begin{equation}\label{morse_seq}
    V(r) = D(-1 + \alpha^2 x^2+...) = -D + \frac{1}{2}M \omega^2(r-r_0)^2 +...,
\end{equation}
 where $\omega^2 = \frac{2D \alpha^2}{M r_o^2}.$\\
Thus, for low vibrational levels, a spectrum  not
deviating very much from that of a harmonic oscillator:
$$E (\nu) = -D + \hbar \omega (\nu + \frac{1}{2}),~~\nu = 0,~1,~2, ...,$$
with $\nu$ the vibrational quantum number, the almost equidistant terms becoming increasingly denser with increasing energy, in consequence of the anharmonicity neglected in \ref{morse_seq}. 
\begin{figure}[h!]
\centering
\begin{subfigure}{.5\textwidth}
  \centering
  \includegraphics[width=1.0\linewidth]{morse_pot.pdf}
\end{subfigure}
\caption{Morse potential}
\label{Morse_potential}
\end{figure}

\subsection{Yukawa Potential}
The Yukawa potential is used to  describe the nuclear attraction between two particles (for example,nucleons), it is often used to compute the spectrum of neutral atoms.\\ 
The Yukawa potential is given by
\begin{equation}\label{yukawa_pot1}
    V(r) = -V_0\frac{e^{a r}}{r},
\end{equation}
where $V_0 = \alpha Z$ and $Z$ is the atomic number, $\alpha = \frac{1}{137}$ is the fine-structure constant and $a$ is the screening parameter.
Our problem is to find the spectrum. The radial part $\eqref{r_eq}$ of the Schrodinger equation in a.u. becomes:
$$-\frac{1}{2}\frac{\partial^2 u}{\partial r^2}+[-V_0\frac{e^{a r}}{r} +\frac{1}{2}\frac{l(l+1)}{r^2}]u = Eu.$$
No exact analytical solution was found, however some approximate analytical solution was obtained using Nikiforof-Uvarov method in the \cite{hamzavi2012approximate}: 
\begin{equation}\label{yukawa_sol}
    E_{nl} = -\frac{a^2}{2m}\frac{(\displaystyle{\frac{m V_0}{a}} - (n+1)^2 - l(2n+l+2))^2}{(n+l+1)^2}
\end{equation}
Compare results of numerical method from the section \ref{sec:numerical} and formula \eqref{yukawa_sol} if $l = 0$. Results are shown in the Figure \ref{fig:Yakawa_spec1}.
\begin{figure}[h!]
\centering
\begin{tabular}{lrr}
\toprule
{n} &  Numerical   &         App. Analytical \\
\midrule
0 & -0.09\textcolor{red}{6186} & -0.097882 \\
1 & -0.024\textcolor{red}{362} & -0.024470 \\
2 & -0.0108\textcolor{red}{54} & -0.010876 \\
3 & -0.00611\textcolor{red}{1} & -0.006118 \\
4 & -0.00391\textcolor{red}{2} & -0.003915 \\
5 & -0.00271\textcolor{red}{7} & -0.002719 \\
6 & -0.001997 & -0.001997 \\
7 & -0.001529 & -0.001529 \\
8 & -0.001208 & -0.001208 \\
9 & -0.00097\textcolor{red}{8} & -0.000979 \\
\bottomrule
\end{tabular}
\caption{$E_{n0}$ in a.u. for the Yukawa Potential}
\label{fig:Yakawa_spec1}
\end{figure}\\
Accordingly to \cite{hamzavi2012approximate}, if the screening paremeter $ a\to 0$, the potential \eqref{yukawa_pot1} becomes the Coulomb potential. Hence, the eigenvalues of \eqref{yukawa_sol} become the spectrum of pure Coulomb potential:
$$E_{nl}^{Coulomb} = -\frac{1}{2} m \frac{V_0^2}{n'^2},$$
where $n' = n+l+1.$




\subsection{Central-force model of deuteron}
The neutron-proton interaction in the idealized situation is described by the following potential:
$$V(r) = - A e^{-r/a}$$
Our problem is to solve the Schrodinger equation for the bound state with $l=0$ (deuteron). As it was determined by experiment there exists only one bound state (see \cite{griffiths2016introduction}):
\begin{equation}
    E = -2.23~\mathrm{MeV}
\end{equation}
The following results are obtained in \cite{griffiths2016introduction}.


\subsubsection{Exact solution}
For $l = 0$ we obtain the following radial Schrodinger equation \eqref{r_eq}:
\begin{equation}
    \frac{d^2 u}{d r^2} + \frac{2 m^*}{\hbar^2}(E+ A e^{-r/a})u = 0,
\end{equation}
where $m^* = \frac{1}{2}$, because we let masses of both nucleons equal. Use of the new variable:
\begin{equation}\label{abbr}
    y = e^{-r/2a}
\end{equation}
we obtain:
\begin{equation}\label{eq_bess_d}
    \frac{d^2 u}{d y^2} + \frac{1}{y}\frac{d u}{d y} + (c^2 - \frac{q^2}{y^2})u=0,
\end{equation}
where
\begin{equation}\label{abbr_2}
    c^2 = \frac{8 m^*}{\hbar^2}A a^2,~~q^2 = -\frac{8 m^*}{\hbar^2}E a^2 > 0
\end{equation}
The equation  \eqref{eq_bess_d} is Bessel's differential equation \eqref{bess_eq} with the general solution:
$$u = C_1 J_q(cy) + C_2 J_{-q} (cy).$$
One the one hand, $r$ blows up if $y = 0$ where $u$ must vanish. Therefore $C_2 = 0:$
\begin{equation}\label{ex_sol_deuteron}
    u = \frac{C_1}{r}J_q(c e^{-r/2a})
\end{equation}
On the other hand, $y = 1$ corresponds to $r = 0$ where $u$ must be finite so that the Bessel function in bound to vanish (\cite{griffiths2016introduction}):
$$J_q(c) = 0.$$
%On the grounds of known numerical values of $m^*$ and $E$ we obtain from \eqref{abbr_2}:

\subsubsection{Approximate solution}
The wave function
$$\widetilde{u} = \frac{C}{r}\displaystyle{\big(e^{-\frac{qr}{2a}} - e^{-\frac{qr}{a}}\big)} $$
has a finite value
$$u(0) = C\frac{q}{2a}$$
at $r=0,$ and decreases, for large $r,$ exponentially with the correct decay length:
$$\exp\bigg(-\frac{qr}{2a}\bigg) = \exp\bigg(-r \sqrt{\frac{2 m^* |E|}{\hbar^2}}\bigg).$$
The normalization constant $C$ can be obtained from 
$$4 \pi \displaystyle{\int\limits_{0}^ {\infty}} dr~ r^2 \widetilde{u}(r)^2 = 1;$$
\begin{equation}\label{f:41}
    C = \sqrt{\frac{3q}{2 \pi a}}.
\end{equation}
By putting the exact solution \eqref{abbr_2} in the formula \eqref{f:41} we obtain the exact answer for $E$. By using appproximation $\widetilde{u}$ we obtain an approximation for the energy:
\begin{equation}\label{integral}
    E = 4 \pi \int\limits_{0}^{\infty} dr ~r^2 \bigg[\frac{\hbar^2}{2 m^*}(du/dr)^2 -A e ^{-r/a} u^2\bigg]
\end{equation}
Using the equation \eqref{abbr_2}  for $u$ the formula \eqref{f:41} yields the exact eigenvalue $E$. Using instead the approximate function $\widetilde{u}$, we find the approximate eigenvalue $\widetilde{E}$.\\
The evaluation of \eqref{integral} with \eqref{ex_sol_deuteron} has the following form:
\begin{equation}
    E = \frac{\hbar^2}{4 m^* a^2}q^2 - 6 A \bigg[\frac{1}{1 + \frac{1}{q}} - \frac{1}{\frac{3}{2} + \frac{1}{q}} +  \frac{1}{2 + \frac{1}{q}} \bigg]
\end{equation}
Some numerical results: $\widetilde{E}=-2.18 \text{ MeV}$ if $a = 2.18 \text{ fm}$ and $A = 32.7 \text{ MeV}$. The correct value $E = -2.23 \text{ MeV}$ (from \cite{griffiths2016introduction}).

\subsection{Convergence analysis}
We also investageted the convergence rate correnspondinly to the grid size for the hydrogen atom.  Results are presented in the Figure \ref{h2_grid}. We observed the quadratic convergence. For more detailed information see the section \ref{appendix}.
\begin{figure}[h!]
\centering
\begin{subfigure}{.5\textwidth}
  \centering
  \includegraphics[width=1.0\linewidth]{h2_grid.pdf}
\end{subfigure}
\caption{Convergence for the hydrogen atom}
\label{h2_grid}
\end{figure}



\section{Conclusion}
%In this work we have investigated the spectrum problem of a particle in some spherically symmetric potentials by constructing the numerical scheme by discretizing the laplace differential operator using the finite difference and solving corresponding eigenvalue problem. \\
%As a result, we have obtained the numerical results for the following potentials, which describes different types of interactions:  the spherical oscillator, the hydrogen-like atom; the Hulthen potential, the Morse potential.  We  compared these results with the known analytical solutions. For the infinite spherical potential well and  finite spherical potential well we used the Newton method.  As for  the Woods-Saxon potential, the numerical results was obtained by the extrapolation method. This result is interesting  from physical point of view since there are no known analytical expression for the energy. For the Yukawa potential  there is no exact analytical solution, but some approximate analytical solution is known.  Finally,  the central-force model of deuteron was investigated.
In this work we have investigated the spectrum problem for an electron in several spherically symmetric potentials by constructing the numerical scheme of solving the eigenvalue problem. We used the second-order discretization scheme for the Hamiltonian operator and solved corresponding eigenvalue problems by various methods. Numerical results obtained by numerical methods were compared with the analytical ones if the latter existed. If analytical solutions for a potential did not exist we compared results obtained from various numerical or approximate methods.\\
Developed software tools will be used in educational process for students of 'Materials, devices and nanotechnology' master's programme.



\section{Appendix}\label{appendix}
The purpose of this section is to expand on some of the techniques and values used in numerical computations. All programs were written in Python 3 using \texttt{numpy} and \texttt{scipy} libraries.
\begin{center}
		\large
		\textbf{ Infinite spherical well}		\\[0.5 cm]
\end{center}
The potential is defined by 
$$E_{nl} = \frac{\hbar^2}{2ma^2}\beta_{nl}^2,$$
where $\beta_{nl}$ -  $n^{th}$ zero of the $l^{th}$ spherical Bessel function $j_n(x) = (-x)^n\bigg(\displaystyle{\frac{1}{x} \frac{d}{dx}}\bigg)^n \frac{\sin{x}}{x}.$
To find zeros we used the Newton method. Results are summarized in the Table \ref{bess_0}.

\begin{figure}[h!]
\centering
\begin{tabular}{lrrrr}
\toprule
{} &  \ $n=1$ &   $n=2$ &   $n=3$ &   $n=4$ \\
\midrule
$l=0$ &  3.142 &   6.283 &   9.425 &  12.566 \\
$l=1$ &  4.493 &   7.725 &  10.904 &  14.066 \\
$l=2$ &  5.763 &   9.095 &  12.323 &  15.515 \\
$l=3$ &  6.988 &  10.417 &  13.698 &  16.924 \\
$l=4$ &  8.183 &  11.705 &  15.040 &  18.301 \\
\bottomrule
\end{tabular}
\caption{Bessel Function Zeros}
\label{bess_0}
\end{figure}
For further computation we assume the atomic units, so $\hbar =  1$, $m=  1$:
$$E_{nl} = \frac{1}{2a^2}\beta_{nl}^2$$
As an example we consider infinite spherical well with $a= 5$ a.u.
The results are presented in the Figure \ref{fig:inf_well}.

\begin{center}
		\large
		\textbf{Finite spherical well}		\\[0.5 cm]
\end{center}
In case $l=0$ the particle spectrum is defined by the following formula (in the  atomic units):
$$\tan(\sqrt{2} a \sqrt{V_0-E})=-\sqrt{\frac{V_0}{E}-1}.$$ 
We solved the this equation by using the Newton's method. As an example we consider finite spherical well with $ a = 5 $ a.u., $ V_0 = 10$ a.u.  The results are shown in the Figure~\ref{fig:finite_well_sol}.
More illustrations for our finite spherical well
%\pagebreak
\begin{figure}[h!]
\centering
\begin{subfigure}{.5\textwidth}
  \centering
  \includegraphics[width=1.0\linewidth]{wave_func_l0.pdf}
  \caption{Wave functions}
  \label{fig1:WS_spc}
\end{subfigure}%
\begin{subfigure}{.5\textwidth}
  \centering
  \includegraphics[width=1.0\linewidth]{finite_3.pdf}
  \caption{Level sets}
  \label{fig:wave_func}
\end{subfigure}
\caption{Finite spherical well in case $l=0$}
\label{fig:WS_potential}
\end{figure}

In case $l=1$ we have the following expression (in the atomic units):
$$\tan(\sqrt{2} a \sqrt{V_0-E}) = \frac{a E \sqrt{2(V_0 - E)}}{V_0+a V_0 \sqrt{2E} -a \sqrt{2} E^{3/2}}.$$
We also solved the this equation by using the Newton's method with the same values of the parameters. The results are shown in the Figure~\ref{fig:fin_well_l1}.

\begin{center}
		\large
		\textbf{Isotropic Harmonic Oscillator}		\\[0.5 cm]
\end{center}
The analytical solution for the energies of the spherical oscillator is given by
$$E_{nl} = \hbar \omega (2 n +l+\frac{3}{2}).$$
For the numerical method described in the Section \ref{sec:numerical} we assume the following values for $\omega = \sqrt{0.12}$ and the grid size $N = 2000.$ The results are illustrated in the Figures \ref{table:Harm_osc} and \ref{fig:Harm_osc}.

\begin{center}
		\large
		\textbf{Hydrogen Atom}		\\[0.5 cm]
\end{center}
The hydrogen atom spectrum are defined (in a. u.) by 
$$E_n = -\frac{1}{2 n^2}$$
Results of the numerical method are presented in the Figures \ref{fig:h2_bar} and \ref{fig:h2_spectrum}. We investagated the convergence rate, and results are shown in the Figure \ref{h2_grid}.
We get acceptable results by using the sufficiently large grid size $N = 15000$ in comparison with, for example, the spherical oscillator. It can be explained by the singularity of the potential:
$$V(r) = -\frac{1}{r}.$$
The method convergence could be improved by a non-uniform grid around zero or by using a larger number of terms in the finite difference from the Section \ref{sec:numerical}.

\begin{center}
		\large
		\textbf{Woods-Saxon potential}		\\[0.5 cm]
\end{center}
There is no analytical solution. So for investigation of the Woods-Saxon potential spectrum we use the numerical method from the section \ref{sec:numerical}. The radial equation \eqref{r_eq} in case $l=0$ says 
$$-\frac{1}{2}\frac{\partial^2 u}{\partial r^2 }- \frac{V_0}{1+e^\frac{r-R}{a}}u = Eu.$$
For solving this eigenvalue problem we assume the following values for the grid size $N = 3000$,  $V_0 = 10$ a. u., $R = 5.0$ a.u. Resulting energies and wave functions are shown in the Figure \ref{fig:WS_potential1}.

\begin{center}
		\large
		\textbf{Hulthen Potential}		\\[0.5 cm]
\end{center}
The Hulthen potential spectrum in the atomiv units is defined by
$$E_n = -V_0\bigg(\frac{2 V_0 a^2 - n^2}{2n a \sqrt{2V_0}}\bigg)^2$$
and the the following condition
$$2 V_0 a^2 > n^2.$$
In our calculations we let  $V_0 = 10$ a.u., $a = 0.5$ a. u and the grid size $N = 3000$.  From the condition  $2.5 > n^2,$ we obtain  two energy levels. Results are presented in the Figure \ref{fig:Hult_spectrum}.


\begin{center}
		\large
		\textbf{Morse potential}		\\[0.5 cm]
\end{center}
The vibrations of a two-atomic molecule are described by
$$V(r) = D(e^{-2\alpha x} - 2e^{-\alpha x}).$$
The analytical solution for the energies of the Morse potential with $l=0$ is given by
$$E_n = -D + \hbar \omega [(n+\frac{1}{2}) - \frac{1}{\xi}(n+\frac{1}{2})^2],$$
where $\xi = \frac{2 \gamma}{\alpha},$ $\gamma^2 = \frac{2 M D r_0^2}{\hbar^2},$ and $\omega$ can be found from the following equation: $\hbar \omega = \frac{\hbar^2}{2 M  r_0^2}.$
We have investigated  the hydrogen atom spectrum, and the special parametes for the potential formula were experimentally established such as $\alpha = 1.440,$  $D= 0.71702$ a.u., $r_0= 0,13984$ a.u. For numerical solution we let the grid size $N = 8000$ and the molecule mass $m = 3674.30535 $ a.u, $\omega  = 0.1 $ a.u. Results are shown in the Figure \ref{Mor_spectrum}.

\begin{center}
		\large
		\textbf{Yukawa potential}		\\[0.5 cm]
\end{center}
The Yukawa potential is given by
\begin{equation}\label{yukawa_pot}
    V(r) = -V_0\frac{e^{a r}}{r},
\end{equation}
where $V_0 = \alpha Z$ and $Z$ is the atomic number, $\alpha = \frac{1}{137}$ is the fine-structure constant and $a$ is the screening parameter.\\
There is no exact analytical solution, however some approximate analytical solution is known: 
$$E_{nl} = -\frac{a^2}{2m}\frac{(\displaystyle{\frac{m V_0}{a}} - (n+1)^2 - l(2n+l+2))^2}{(n+l+1)^2}.$$
For the numerical method described in the Section \ref{sec:numerical} we assume the following values for $V_0 = \frac{1}{137}$ (we investigate $H_2$), $a =$ 0.002$V_0$,  $m = 3674.30535 $ and the grid size $N = 1000.$ The results are illustrated in the Figure \ref{fig:Yakawa_spec1}.



%$$\lambda \sin^2 {\theta}+\frac{\sin{\theta}}{\theta}\frac{\d}{\d \theta}$$

\bibliography{electron}
\bibliographystyle{plain}
\end{document}
	
